{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Omar/Desktop/ORION/orion/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _PerfilPage;\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/auth.service\";\nimport * as i2 from \"@angular/fire/compat/auth\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@ionic/angular\";\nimport * as i5 from \"../../componentes/header/header.component\";\nexport class PerfilPage {\n  constructor(authService, afAuth,\n  // Servicio para obtener el estado del usuario\n  router, alertCtrl) {\n    this.authService = authService;\n    this.afAuth = afAuth;\n    this.router = router;\n    this.alertCtrl = alertCtrl;\n  }\n  ngOnInit() {\n    // Suscribirse al estado de autenticación para obtener los datos del usuario\n    this.afAuth.authState.subscribe(user => {\n      if (user) {\n        this.userData = user; // Asignar los datos del usuario\n        this.userStats = JSON.parse(localStorage.getItem('userStats')); // Obtener estadísticas del usuario\n      } else {\n        this.router.navigate(['/login']); // Redirigir si no hay sesión activa\n      }\n    });\n  }\n  cerrarSesion() {\n    this.authService.signOut(); // Llama al método de cerrar sesión\n    this.router.navigate(['/login']); // Redirige al login\n  }\n  // Función para editar el nombre de usuario\n  editarNombre() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var _this$userStats, _this$userData;\n      const alert = yield _this.alertCtrl.create({\n        header: 'Editar Nombre',\n        inputs: [{\n          name: 'displayName',\n          type: 'text',\n          placeholder: 'Ingresa tu nuevo nombre',\n          value: ((_this$userStats = _this.userStats) === null || _this$userStats === void 0 ? void 0 : _this$userStats.displayName) || ((_this$userData = _this.userData) === null || _this$userData === void 0 ? void 0 : _this$userData.displayName) || ''\n        }],\n        buttons: [{\n          text: 'Cancelar',\n          role: 'cancel'\n        }, {\n          text: 'Guardar',\n          handler: function () {\n            var _ref = _asyncToGenerator(function* (data) {\n              if (data.displayName) {\n                try {\n                  yield _this.authService.updateDisplayName(data.displayName);\n                  _this.userStats.displayName = data.displayName; // Actualizar vista\n                  console.log('Nombre actualizado exitosamente:', data.displayName);\n                } catch (error) {\n                  console.error('Error al actualizar el nombre:', error);\n                }\n              }\n            });\n            return function handler(_x) {\n              return _ref.apply(this, arguments);\n            };\n          }()\n        }]\n      });\n      yield alert.present();\n    })();\n  }\n}\n_PerfilPage = PerfilPage;\n_PerfilPage.ɵfac = function PerfilPage_Factory(__ngFactoryType__) {\n  return new (__ngFactoryType__ || _PerfilPage)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.AngularFireAuth), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.AlertController));\n};\n_PerfilPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _PerfilPage,\n  selectors: [[\"app-perfil\"]],\n  decls: 10,\n  vars: 3,\n  consts: [[\"titulo\", \"Perfil\"], [1, \"background\", 3, \"fullscreen\"], [1, \"perfil-container\", \"ion-text-center\"], [\"name\", \"person-circle-outline\", 1, \"profile-icon\"], [1, \"username\"], [1, \"user-email\"], [\"color\", \"danger\", 3, \"click\"]],\n  template: function PerfilPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-header\", 0);\n      i0.ɵɵelementStart(1, \"ion-content\", 1)(2, \"div\", 2);\n      i0.ɵɵelement(3, \"ion-icon\", 3);\n      i0.ɵɵelementStart(4, \"h2\", 4);\n      i0.ɵɵtext(5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"p\", 5);\n      i0.ɵɵtext(7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"ion-button\", 6);\n      i0.ɵɵlistener(\"click\", function PerfilPage_Template_ion_button_click_8_listener() {\n        return ctx.cerrarSesion();\n      });\n      i0.ɵɵtext(9, \" Cerrar sesi\\u00F3n \");\n      i0.ɵɵelementEnd()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance();\n      i0.ɵɵproperty(\"fullscreen\", true);\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate((ctx.userStats == null ? null : ctx.userStats.displayName) || \"Usuario\");\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate((ctx.userData == null ? null : ctx.userData.email) || \"Correo no disponible\");\n    }\n  },\n  dependencies: [i4.IonButton, i4.IonContent, i4.IonIcon, i5.HeaderComponent],\n  styles: [\"ion-content.background[_ngcontent-%COMP%] {\\n  --background: url('background.jpg') 0 0/100% 100% no-repeat;\\n}\\n\\n.perfil-container[_ngcontent-%COMP%] {\\n  margin-top: 40px;\\n}\\n\\n.profile-icon[_ngcontent-%COMP%] {\\n  font-size: 120px;\\n  color: #f2f2f2;\\n}\\n\\n.username[_ngcontent-%COMP%] {\\n  font-weight: bold;\\n  font-size: 1.5rem;\\n  margin-top: 10px;\\n  color: #f2f2f2;\\n}\\n\\n.user-email[_ngcontent-%COMP%] {\\n  font-size: 1rem;\\n  color: #ffffff;\\n  margin-bottom: 20px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFnZXMvcGVyZmlsL3BlcmZpbC5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSwyREFBQTtBQUNKOztBQUdBO0VBQ0ksZ0JBQUE7QUFBSjs7QUFHQTtFQUNJLGdCQUFBO0VBQ0EsY0FBQTtBQUFKOztBQUdBO0VBQ0ksaUJBQUE7RUFDQSxpQkFBQTtFQUNBLGdCQUFBO0VBQ0EsY0FBQTtBQUFKOztBQUdBO0VBQ0ksZUFBQTtFQUNBLGNBQUE7RUFDQSxtQkFBQTtBQUFKIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLWNvbnRlbnQuYmFja2dyb3VuZCB7XHJcbiAgICAtLWJhY2tncm91bmQ6IHVybCguLi8uLi8uLi9hc3NldHMvaW1nL2JhY2tncm91bmQuanBnKSAwIDAvMTAwJSAxMDAlIG5vLXJlcGVhdDtcclxufVxyXG5cclxuXHJcbi5wZXJmaWwtY29udGFpbmVyIHtcclxuICAgIG1hcmdpbi10b3A6IDQwcHg7XHJcbn1cclxuXHJcbi5wcm9maWxlLWljb24ge1xyXG4gICAgZm9udC1zaXplOiAxMjBweDtcclxuICAgIGNvbG9yOiAjZjJmMmYyO1xyXG59XHJcblxyXG4udXNlcm5hbWUge1xyXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICBmb250LXNpemU6IDEuNXJlbTtcclxuICAgIG1hcmdpbi10b3A6IDEwcHg7XHJcbiAgICBjb2xvcjogI2YyZjJmMjtcclxufVxyXG5cclxuLnVzZXItZW1haWwge1xyXG4gICAgZm9udC1zaXplOiAxcmVtO1xyXG4gICAgY29sb3I6ICNmZmZmZmY7XHJcbiAgICBtYXJnaW4tYm90dG9tOiAyMHB4O1xyXG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["PerfilPage","constructor","authService","afAuth","router","alertCtrl","ngOnInit","authState","subscribe","user","userData","userStats","JSON","parse","localStorage","getItem","navigate","cerrarSesion","signOut","editarNombre","_this","_asyncToGenerator","_this$userStats","_this$userData","alert","create","header","inputs","name","type","placeholder","value","displayName","buttons","text","role","handler","_ref","data","updateDisplayName","console","log","error","_x","apply","arguments","present","i0","ɵɵdirectiveInject","i1","AuthService","i2","AngularFireAuth","i3","Router","i4","AlertController","selectors","decls","vars","consts","template","PerfilPage_Template","rf","ctx","ɵɵelement","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","PerfilPage_Template_ion_button_click_8_listener","ɵɵadvance","ɵɵproperty","ɵɵtextInterpolate","email"],"sources":["C:\\Users\\Omar\\Desktop\\ORION\\orion\\src\\app\\pages\\perfil\\perfil.page.ts","C:\\Users\\Omar\\Desktop\\ORION\\orion\\src\\app\\pages\\perfil\\perfil.page.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { AuthService } from 'src/app/services/auth.service';\r\nimport { AngularFireAuth } from '@angular/fire/compat/auth';\r\nimport { AlertController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-perfil',\r\n  templateUrl: './perfil.page.html',\r\n  styleUrls: ['./perfil.page.scss'],\r\n})\r\nexport class PerfilPage implements OnInit {\r\n  // Variable para almacenar los datos del usuario\r\n  userData: any;\r\n  userStats: any; // Estadísticas del usuario (Firestore)\r\n\r\n\r\n  constructor(\r\n    private authService: AuthService,\r\n    private afAuth: AngularFireAuth, // Servicio para obtener el estado del usuario\r\n    private router: Router,\r\n    private alertCtrl: AlertController\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    // Suscribirse al estado de autenticación para obtener los datos del usuario\r\n    this.afAuth.authState.subscribe((user) => {\r\n      if (user) {\r\n        this.userData = user; // Asignar los datos del usuario\r\n        this.userStats = JSON.parse(localStorage.getItem('userStats')!); // Obtener estadísticas del usuario\r\n\r\n      } else {\r\n        this.router.navigate(['/login']); // Redirigir si no hay sesión activa\r\n      }\r\n    });\r\n  }\r\n\r\n  cerrarSesion() {\r\n    this.authService.signOut(); // Llama al método de cerrar sesión\r\n    this.router.navigate(['/login']); // Redirige al login\r\n  }\r\n\r\n    // Función para editar el nombre de usuario\r\n    async editarNombre() {\r\n      const alert = await this.alertCtrl.create({\r\n        header: 'Editar Nombre',\r\n        inputs: [\r\n          {\r\n            name: 'displayName',\r\n            type: 'text',\r\n            placeholder: 'Ingresa tu nuevo nombre',\r\n            value: this.userStats?.displayName || this.userData?.displayName || '',\r\n          },\r\n        ],\r\n        buttons: [\r\n          {\r\n            text: 'Cancelar',\r\n            role: 'cancel',\r\n          },\r\n          {\r\n            text: 'Guardar',\r\n            handler: async (data) => {\r\n              if (data.displayName) {\r\n                try {\r\n                  await this.authService.updateDisplayName(data.displayName);\r\n                  this.userStats.displayName = data.displayName; // Actualizar vista\r\n                  console.log('Nombre actualizado exitosamente:', data.displayName);\r\n                } catch (error) {\r\n                  console.error('Error al actualizar el nombre:', error);\r\n                }\r\n              }\r\n            },\r\n          },\r\n        ],\r\n      });\r\n  \r\n      await alert.present();\r\n    }\r\n}\r\n","<!--HTML para mostrar el perfil del usuario activo.-->\r\n<app-header titulo=\"Perfil\"></app-header>\r\n<ion-content [fullscreen]=\"true\" class=\"background\">\r\n  <div class=\"perfil-container ion-text-center\">\r\n    <ion-icon name=\"person-circle-outline\" class=\"profile-icon\"></ion-icon>\r\n    <!-- Muestra el nombre y el correo del usuario -->\r\n    <h2 class=\"username\">{{ userStats?.displayName || 'Usuario' }}</h2>\r\n    <p class=\"user-email\">{{ userData?.email || 'Correo no disponible' }}</p>\r\n\r\n    <!-- Botón para cerrar sesión -->\r\n    <ion-button color=\"danger\" (click)=\"cerrarSesion()\">\r\n      Cerrar sesión\r\n    </ion-button>\r\n  </div>\r\n</ion-content>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}